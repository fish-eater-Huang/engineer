# 新工程操作键位

## **1 比赛键位**

遥控器右1

### **底盘控制**

| 键位                 | 功能                     |
| -------------------- | ------------------------ |
| wasd                 | 底盘移动                 |
| ctrl/shift+wasd      | 慢速/快速移动            |
| q                    | 陀螺                     |
| shift+q              | 扭腰                     |
| ctrl+q               | 关闭陀螺（不影响机械臂） |
| f（行驶模式）        | 关闭陀螺，暂停任务       |
| 鼠标移动（行驶模式） | J0+云台pitch，底盘跟随   |

### **机械臂控制**

1 遥控器

| 遥控器挡位 | 左1右1 | 左2右1 | 左3右1（自定义控制器） |
| ---------- | ------ | ------ | ---------------------- |
| 左摇杆x    | x      | x      | x                      |
| 左摇杆y    | y      | y      | y                      |
| 拨轮       | roll   | z      | z                      |
| 右摇杆x    | yaw    | yaw    | 保留（气泵/任务等）    |
| 右摇杆y    | pitch  | pitch  | 保留（气泵/任务等）    |

2 手控（自定义控制器，imu×3+主控×1）

遥控器左3右1，在线-接图传链路，离线-UART线直连

### **任务**

| 键位               | 功能                 |
| ------------------ | -------------------- |
| f                  | 暂停                 |
| ctrl+f             | 回到默认模式         |
| e                  | 进入常规取矿模式     |
| e->shift+e         | 三连                 |
| e->ctrl+e          | 单取                 |
| e->c/v             | 选择左/右存矿位      |
| r                  | 进入兑换模式         |
| r->c/v             | 出矿+机械臂复位      |
| r->ctrl+c/v        | 手动出矿             |
| r->g               | 推入                 |
| b                  | 进入地面取矿模式     |
| b->ctrl+b          | 地面单取             |
| b->c/v             | 选择左/右存矿位      |
| r/e/b->鼠标左/右键 | 打开/关闭机械臂气泵  |
| zx                 | 保留（空接、视觉等） |

## **2 遥控器测试键位**

机械臂控制可直接使用比赛键位（即遥控器右2档）进行测试。

| 遥控器挡位 | 左1右2（移动） | 左2右2    | 左3右2         |
| ---------- | -------------- | --------- | -------------- |
| 左摇杆x    | yaw            | 单取存矿  | 机械臂气泵舵机 |
| 左摇杆y    | pitch          | 单取取矿  | 机械臂气泵电机 |
| 右摇杆x    | vx             | 气泵      | 存矿气泵舵机   |
| 右摇杆y    | vy             | 三连/地面 | 存矿气泵电机   |
| 拨轮       | 陀螺           | 暂停/复位 |                |

## **note**

任务分为：1. 常规取矿（+存矿）；2. （出矿+）兑换；3. 地面取矿；\*4. 空接；\*5. 救援

存矿/出矿默认可完全自动化，若出现意外情况中断任务手动控制。

任务暂停后/手动完成某一步骤后是否继续执行自动化任务？记忆当前任务校准位置替代默认位置？实现方式

常规取矿步骤细化：

1. 单取（小资源岛第二优先级，大资源岛常规）
   1. 进入取矿模式，机械臂移至常规取矿默认位置
   2. 控制机械臂对位
   3. 开启机械臂气泵
   4. 机械臂走取矿轨迹（x'+,z'+,x'-）
   5. 机械臂走存矿轨迹（左/右存矿上方,z-）
   6. 开启存矿气泵
   7. 关闭机械臂气泵
   
   风险因素：
   1. 对位失误/未成功吸起：可重新对位执行整个单取流程
   2. 左右存矿选择（键位选择/程序记录？可靠性？）
   3. 非1原因在轨迹中暂停任务：可能原因（所选侧已有存矿/碰撞/误操作）？（**训练+测试**）
   4. 3后续继续任务/切为单步/手动？气泵处理？

   初步结论：取矿存矿分步，1键进模式+1键取矿+2键选存矿位置+1键暂停

2. 三连（小资源岛常规）
   1. 进入取矿模式，机械臂移至取矿默认位置
   2. 控制机械臂对位
   3. 单取中存左
   4. 单取左存右
   5. 单取右

   风险因素：
   1. 暂停后处理（如单取右）
   2. 对位偏移过大超出工作空间（暂停 ->1）

   初步结论：1键进模式+1键开始+1键暂停

兑换步骤细化：

1. 自动出矿
   1. 进入兑换模式，机械臂移至兑换默认位置（已吸矿可直接开始兑换步骤）
   2. 选择出矿位
   3. 机械臂走出矿轨迹1（左/右存矿上方,z-）
   4. 开启机械臂气泵
   5. 关闭存矿气泵，对应侧放气
   6. 机械臂走出矿轨迹2（z+，兑换默认位置）

   风险因素：
   1. 存矿位置偏移，吸取失败等（暂停，转手动出矿）

   初步结论：1键进模式+2键选存矿位置+1键暂停
   
2. 手动出矿
   1. 进入兑换模式，机械臂移至兑换默认位置
   2. 选择出矿位
   3. 机械臂走出矿轨迹1（左/右存矿上方,z-）
   4. (new)控制机械臂对位（对位完成后继续）
   5. 开启机械臂气泵
   6. 关闭存矿气泵，对应侧放气
   7. 机械臂走出矿轨迹2（z+，兑换默认位置）

   初步结论：1键进模式+2键选存矿位置+1键暂停

3. 兑换对位
   1. 机械臂移至兑换默认位置
   2. 控制机械臂对位

4. 推入
   1. 机械臂推入轨迹1（z''+）
   2. 关闭机械臂气泵
   3. 机械臂推入轨迹2（rx''+90,y''-,兑换默认位置）

   初步结论：1键进模式+1键开始+1键暂停
